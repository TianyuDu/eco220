df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
treatment_rp = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
setwd("/Users/tianyudu/Documents/UToronto/Course/ECO220/DACM/eco220/data")
rm(list=ls())
library(readxl)
library(psych)
# ==== Q1 ====
df = read_excel("char_give.xlsx")
excel_sheets("char_give.xlsx")
size = nrow(df)  # Get total observations
# ==== Q2 ====
# (a) Verify control group response rate and tratement group response rate.
# Control group
n_control = nrow(df[
which(df$control==1),
])
control_rp = nrow(df[
which((df$control==1) & (df$gave==1)),
]) / nrow(df[
which(df$control==1),
])
# Tratement group
n_treatment = nrow(df[
which(df$treatment==1),
])
treatment_rp = nrow(df[
which((df$treatment==1) & (df$gave==1)),
]) / nrow(df[
which(df$treatment==1),
])
# (b) Standard error
control_se = sqrt(control_rp * (1 - control_rp) / n_control)
treatment_se = sqrt(treatment_rp * (1 - treatment_rp) / n_tratement)
# ==== Q3 ====
p1 <- control_rp
n1 <- n_control
p2 <- treatment_rp
n2 <- n_treatment
# (a) Standard Error
se <- sqrt(
(p1 * (1 - p1)) / n1 + (p2 * (1 - p2)/ n2)
)
# (b) 95 % Confidence Interval
me <- qnorm(0.975) * se
lcl <- (p2 - p1) - me
ucl <- (p2 - p1) + me
cat("95% confidence interval: ", lcl, ",", ucl)
# ==== Q4 ====
# Blue State only
# Control total
n1 = nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
control_rp = nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
treatment_rp = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
setwd("/Users/tianyudu/Documents/UToronto/Course/ECO220/DACM/eco220/data")
rm(list=ls())
library(readxl)
library(psych)
# ==== Q1 ====
df = read_excel("char_give.xlsx")
excel_sheets("char_give.xlsx")
size = nrow(df)  # Get total observations
# ==== Q2 ====
# (a) Verify control group response rate and tratement group response rate.
# Control group
n_control = nrow(df[
which(df$control==1),
])
control_rp = nrow(df[
which((df$control==1) & (df$gave==1)),
]) / nrow(df[
which(df$control==1),
])
# Tratement group
n_treatment = nrow(df[
which(df$treatment==1),
])
treatment_rp = nrow(df[
which((df$treatment==1) & (df$gave==1)),
]) / nrow(df[
which(df$treatment==1),
])
# (b) Standard error
control_se = sqrt(control_rp * (1 - control_rp) / n_control)
treatment_se = sqrt(treatment_rp * (1 - treatment_rp) / n_tratement)
# ==== Q3 ====
p1 <- control_rp
n1 <- n_control
p2 <- treatment_rp
n2 <- n_treatment
# (a) Standard Error
se <- sqrt(
(p1 * (1 - p1)) / n1 + (p2 * (1 - p2)/ n2)
)
# (b) 95 % Confidence Interval
me <- qnorm(0.975) * se
lcl <- (p2 - p1) - me
ucl <- (p2 - p1) + me
cat("95% confidence interval: ", lcl, ",", ucl)
# ==== Q4 ====
# Blue State only
# Control total
n1 = nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
control_rp = nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
treatment_rp = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
setwd("/Users/tianyudu/Documents/UToronto/Course/ECO220/DACM/eco220/data")
rm(list=ls())
library(readxl)
library(psych)
# ==== Q1 ====
df = read_excel("char_give.xlsx")
excel_sheets("char_give.xlsx")
size = nrow(df)  # Get total observations
# ==== Q2 ====
# (a) Verify control group response rate and tratement group response rate.
# Control group
n_control = nrow(df[
which(df$control==1),
])
control_rp = nrow(df[
which((df$control==1) & (df$gave==1)),
]) / nrow(df[
which(df$control==1),
])
# Tratement group
n_treatment = nrow(df[
which(df$treatment==1),
])
treatment_rp = nrow(df[
which((df$treatment==1) & (df$gave==1)),
]) / nrow(df[
which(df$treatment==1),
])
# (b) Standard error
control_se = sqrt(control_rp * (1 - control_rp) / n_control)
treatment_se = sqrt(treatment_rp * (1 - treatment_rp) / n_treatment)
# ==== Q3 ====
p1 <- control_rp
n1 <- n_control
p2 <- treatment_rp
n2 <- n_treatment
# (a) Standard Error
se <- sqrt(
(p1 * (1 - p1)) / n1 + (p2 * (1 - p2)/ n2)
)
# (b) 95 % Confidence Interval
me <- qnorm(0.975) * se
lcl <- (p2 - p1) - me
ucl <- (p2 - p1) + me
cat("95% confidence interval: ", lcl, ",", ucl)
# ==== Q4 ====
# Blue State only
# Control total
n1 = nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
control_rp = nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
treatment_rp = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
n1 = nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
p1 = nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
p2 = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
p1
p2
# (b)
point_est = p2 - p1
point_est
# Control total
n1 = nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
p1 = nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
p2 = nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
# (b)
point_est = p2 - p1
point_est
p1
p2
se = sqrt(
(p1*(1-p1)/n1) + (p2*(1-p2)/n2)
)
se
qnorm(0.9975)
me = qnorm(1 - 0.01/2) * se
me
me = qnorm(1 - 0.01/2) * se
lcl = point_est + me
ucl = point_est - me
cat("99% Confidence interval", lcl, ucl)
# 99 % confidence interval.
point_est = p2 - p1
se = sqrt(
(p1 * (1 - p1) / n1) + (p2 * (1 - p2) / n2)
)
me = qnorm(1 - 0.01/2) * se
lcl = point_est - me
ucl = point_est + me
cat("99% Confidence interval", lcl, ucl)
n1 = nrow(
df[which((df$control==1) & (df$red_state==1)), ]
)
p1 = nrow(
df[which((df$control==1) & (df$red_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 = nrow(
df[which(df$treatment==1 & df$red_state==1), ]
)
p2 = nrow(
df[which(df$treatment==1 & df$red_state==1 & df$gave==1), ]
) / n2
point_est = p2 - p1
se = sqrt(
(p1 * (1 - p1) / n1) + (p2 * (1 - p2) / n2)
)
me = qnorm(1 - 0.1/2) * se
lcl = point_est - me
ucl = point_est + me
cat("90% Confidence interval in blue state", lcl, ucl)
setwd("/Users/tianyudu/Documents/UToronto/Course/ECO220/DACM/eco220/data")
rm(list=ls())
library(readxl)
library(psych)
# ==== Q1 ====
df = read_excel("char_give.xlsx")
excel_sheets("char_give.xlsx")
size <- nrow(df)  # Get total observations
# ==== Q2 ====
# (a) Verify control group response rate and tratement group response rate.
# Control group
n_control <- nrow(df[
which(df$control==1),
])
control_rp <- nrow(df[
which((df$control==1) & (df$gave==1)),
]) / nrow(df[
which(df$control==1),
])
# Tratement group
n_treatment <- nrow(df[
which(df$treatment==1),
])
treatment_rp <- nrow(df[
which((df$treatment==1) & (df$gave==1)),
]) / nrow(df[
which(df$treatment==1),
])
# (b) Standard error
control_se <- sqrt(control_rp * (1 - control_rp) / n_control)
treatment_se <- sqrt(treatment_rp * (1 - treatment_rp) / n_treatment)
# ==== Q3 ====
p1 <- control_rp
n1 <- n_control
p2 <- treatment_rp
n2 <- n_treatment
# (a) Standard Error
se <- sqrt(
(p1 * (1 - p1)) / n1 + (p2 * (1 - p2)/ n2)
)
# (b) 95 % Confidence Interval
me <- qnorm(0.975) * se
lcl <- (p2 - p1) - me
ucl <- (p2 - p1) + me
cat("95% confidence interval: ", lcl, ",", ucl)
# ==== Q4 ====
# Blue State only
# (a)
# Control total
n1 <- nrow(
df[which((df$control==1) & (df$blue_state==1)), ]
)
p1 <- nrow(
df[which((df$control==1) & (df$blue_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 <- nrow(
df[which(df$treatment==1 & df$blue_state==1), ]
)
p2 <- nrow(
df[which(df$treatment==1 & df$blue_state==1 & df$gave==1), ]
) / n2
# (b)
# 99 % confidence interval.
point_est <- p2 - p1
se <- sqrt(
(p1 * (1 - p1) / n1) + (p2 * (1 - p2) / n2)
)
me <- qnorm(1 - 0.01/2) * se
lcl <- point_est - me
ucl <- point_est + me
cat("99% Confidence interval in blue state", lcl, ucl)
# (c)
# Repeat for red state.
# Control total
n1 <- nrow(
df[which((df$control==1) & (df$red_state==1)), ]
)
p1 <- nrow(
df[which((df$control==1) & (df$red_state==1) & (df$gave==1)), ]
) / n1
# Treatment total
n2 <- nrow(
df[which(df$treatment==1 & df$red_state==1), ]
)
p2 <- nrow(
df[which(df$treatment==1 & df$red_state==1 & df$gave==1), ]
) / n2
point_est = p2 - p1
se <- sqrt(
(p1 * (1 - p1) / n1) + (p2 * (1 - p2) / n2)
)
me <- qnorm(1 - 0.1/2) * se
lcl <- point_est - me
ucl <- point_est + me
cat("90% Confidence interval in blue state", lcl, ucl)
# Interactive tutorial materials. (Page 40)
setwd("/Users/tianyudu/Documents/UToronto/Course/ECO220/DACM/eco220/data")
rm(list=ls())
library(readxl)
library(psych)
df <- read_excel("big_mac_jan_2017.xlsx")
excel_sheets(df)
excel_sheets("big_mac_jan_2017.xlsx")
summary(ddf)
summary(df)
gdp_1000s <- df$gdp_pc_usd_2015 / 1000
gdp_1000s
scatterplot(df$country ~ gdp_1000s)
library(car)
scatterplot(df$country ~ gdp_1000s)
plot(df$country, gdp_1000s)
df$country
plot(df$dollar_price, gdp_1000s)
scatterplot(df$dollar_price ~ gdp_1000s)
plot(df$dollar_price ~ gdp_1000s | cyl)
plot(df$dollar_price ~ gdp_1000s, data=df)
plot(df$dollar_price ~ gdp_1000s)
scatterplot(df$dollar_price ~ gdp_1000s)
scatterplot(df$dollar_price ~ gdp_1000s,
xlab="GDP per person ($1000)", ylab="Big Mac price",
main="Fig1")
scatterplot(df$dollar_price ~ gdp_1000s,
xlab="GDP per person ($1000)", ylab="Big Mac price",
main="Big Mac price in dollar against gdp per person")
# (b)
reg1 <- lm(df$dollar_price ~ gdp_1000s)
summary(reg1)
plot(df$dollar_price ~ gdp_1000s | reg1)
plot(df$dollar_price ~ gdp_1000s)
abline(reg1)
scatterplot(df$dollar_price ~ gdp_1000s)
abline(reg1)
scatterplot(df$dollar_price ~ gdp_1000s,
xlab="GDP per person ($1000)", ylab="Big Mac price",
main="Big Mac price in dollar against gdp per person")
plot(df$dollar_price ~ gdp_1000s)
abline(reg1)
with(plot(df$dollar_price ~ gdp_1000s))
abline(reg1)
reg1
reg1 <- lm(df$dollar_price ~ gdp_1000s)
with(plot(df$dollar_price ~ gdp_1000s))
abline(reg1)
summary(reg1)
cor(df)
# (c)
df$gdp_1000s <- gdp_1000s
reg1 <- lm(dollar_price ~ gdp_1000s, data=df)
with(data=df, plot(dollar_price ~ gdp_1000s),
xlab="GDP per capita ($1000s)", ylab="Big Mac price (US$)",
main="Scatter Chart adding Trendline")
abline(reg1)
summary(reg1)
# (c)
cor(df)
# (c)
cor(data.matrix(df))
# (c)
cor(data.matrix(df[,5:8]))
lm
lm
reg1$residuals
# (d)
reg1$residuals[1]
hist(reg1$coefficients)
hist(reg1$residuals)
install.packages("MASS")
library(MASS)
# (e) Residuals
fit <- fitdistr(reg1$residuals)
# (e) Residuals
fit <- fitdistr(reg1$residuals, "normal")
hist(reg1$residuals)
fit$estimate
fit$n
fit$sd
curve(dnorm(x, fit$estimate[1], fit$estimate[2]))
hist(reg1$residuals)
curve(dnorm(x, fit$estimate[1], fit$estimate[2]))
hist(reg1$residuals, prob=TRUE)
curve(dnorm(x, fit$estimate[1], fit$estimate[2]))
curve(dnorm(x, fit$estimate[1], fit$estimate[2]), add=TRUE)
hist(reg1$residuals, prob=TRUE)
curve(dnorm(x, fit$estimate[1], fit$estimate[2]), add=TRUE)
summary(fit)
als
fit <- fitdistr(reg1$residuals, "normal")
hist(reg1$residuals, prob=TRUE)
curve(dnorm(x, fit$estimate[1], fit$estimate[2]), add=TRUE)
fit$estimate
scatterplot(fitted.values ~ residuals, data=reg1)
#(f)
scatterplot(reg1$fitted.values ~ reg1$residuals)
#(f)
scatterplot(reg1$residuals ~ reg1$fitted.values)
scatterplot(reg1$residuals ~ reg1$fitted.values,
xlab="Predicted Big Mac Price (y-hat)", ylab="Residuals (e)",
main="Diagnostic Plot")
# ==== Q2 ====
# (a)
df <- read_excel("mort_in_figure_3_table_a3.xlsx")
summary(df)
describe(df)
df$age_group
d <- df[which(df$male==0 & df$year==1990)]
d <- df[which(df$male==0 & df$year==1990), ]
d
reg2 <- lm(adj_deaths ~ adj_population, data=d)
summary(reg2)
d <- df[which(df$male==0 & df$year==1990, df$age_group=="0-4 yrs"), ]
d
reg2 <- lm(adzj_deaths/adj_population*1000 ~ quantile, data=d)
reg2 <- lm(adj_deaths/adj_population*1000 ~ quantile, data=d)
summary(reg2)
d$death_per_1000 = d$adj_deaths / (d$adj_population / 1000)
reg2 <- lm(death_per_1000 ~ quantile, data=d)
summary(reg2)
d$death_per_1000 = d$adj_deaths / (d$adj_population)
reg2 <- lm(death_per_1000 ~ quantile, data=d)
summary(reg2)
d$death_per_1000 = d$adj_deaths / (d$adj_population / 1000)
reg2 <- lm(death_per_1000 ~ quantile, data=d)
summary(reg2)
d$death_per_1000 = d$adj_deaths / (d$adj_population * 1000)
reg2 <- lm(death_per_1000 ~ quantile, data=d)
summary(reg2)
d$age_group
d
d <- df[which(df$male==0 & df$year==1990, df$age_group=="0-4 yrs"), ]
d$male
d$year
d$age_group
d <- df[which(df$male==0 & df$year==1990, df$age_group=='0-4 yrs'), ]
d
d$age_group[1]
d <- df[which(df$male==0 & df$year==1990, df$age_group=="0-4 yrs"), ]
d
d <- df[which(df$male==0 & df$year==1990 & df$age_group=="0-4 yrs"), ]
d$death_per_1000 = d$adj_deaths / (d$adj_population / 1000)
reg2 <- lm(death_per_1000 ~ quantile, data=d)
summary(reg2)
